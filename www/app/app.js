// Generated by CoffeeScript 1.8.0
(function() {
  var baseUrl;

  if (window.cordova) {
    baseUrl = 'http://homeclub.us/api';
  } else {
    baseUrl = '/api';
  }

  angular.module("hcMobile", ["ionic", 'ngResource', "hcMobile.controllers", "hcMobile.services"]).run(function($ionicPlatform, $rootScope, $ionicLoading, $timeout, $state, SessionFactory) {
    $ionicPlatform.ready(function() {
      var pushNotification, token;
      pushNotification = window.plugins.pushNotification;
      if (ionic.Platform.isAndroid()) {
        token = localStorage.getItem('Android_token');
        if (!token) {
          pushNotification.register(pushCallbacks.GCM.successfulRegistration, pushCallbacks.errorHandler, {
            senderID: '125902103424',
            ecb: 'pushCallbacks.GCM.onNotification'
          });
        }
      }
      if (ionic.Platform.isIOS()) {
        token = localStorage.getItem('iPhone_token');
        if (!token) {
          pushNotification.register(pushCallbacks.APN.successfulRegistration, pushCallbacks.errorHandler, {
            badge: 'true',
            sound: 'true',
            alert: 'true',
            ecb: 'pushCallbacks.APN.onNotification'
          });
        }
      }
      if (window.cordova && window.cordova.plugins.Keyboard) {
        cordova.plugins.Keyboard.hideKeyboardAccessoryBar(true);
      }
      if (window.StatusBar) {
        return StatusBar.styleDefault();
      }
    });
    $rootScope.showLoading = function(msg) {
      return $ionicLoading.show({
        template: msg || "Loading",
        animation: "fade-in",
        showBackdrop: true,
        maxWidth: 200,
        showDelay: 0
      });
    };
    $rootScope.hideLoading = function() {
      return $ionicLoading.hide();
    };
    $rootScope.toast = function(msg) {
      $rootScope.showLoading(msg);
      return $timeout((function() {
        return $rootScope.hideLoading();
      }), 2999);
    };
    return $rootScope.logout = function() {
      SessionFactory.deleteSession();
      return $state.go('login');
    };
  }).config(function($stateProvider, $urlRouterProvider) {
    $stateProvider.state('app', {
      url: '/app',
      templateUrl: 'app/layout/menu-layout.html',
      abstract: true
    }).state('app.dash', {
      url: '/dash',
      views: {
        mainContent: {
          templateUrl: 'templates/dashboard.html',
          controller: 'DashCtrl'
        }
      }
    }).state('app.sensorSetup', {
      resolve: {
        resolvedCustomerAccount: function($http) {
          return $http.get(baseUrl + '/me/customer-account');
        }
      },
      url: '/sensor-setup',
      views: {
        mainContent: {
          templateUrl: 'templates/sensor-setup.html',
          controller: 'SensorSetupCtrl'
        }
      }
    }).state('login', {
      url: '/login',
      views: {
        '': {
          templateUrl: 'templates/login.html',
          controller: 'SignInCtrl'
        }
      }
    });
    return $urlRouterProvider.otherwise('/login');
  });

}).call(this);
